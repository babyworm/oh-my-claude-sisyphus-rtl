# {{PROJECT_NAME}} - Makefile
# Generated by oh-my-claude-rtl
#
# Detected tools:
{{TOOL_COMMENTS}}
#
# Usage:
#   make lint       - Run linter
#   make sim        - Run simulation
#   make synth      - Run synthesis
#   make clean      - Clean build artifacts
#   make help       - Show this help

# Project configuration
PROJECT := {{PROJECT_NAME}}
TOP_MODULE := {{MODULE_NAME}}
TB_MODULE := tb_$(TOP_MODULE)

# Directories
SRC_DIR := src
TB_DIR := tb
SYNTH_DIR := synth
REPORT_DIR := reports

# Source files
RTL_SOURCES := $(wildcard $(SRC_DIR)/*.sv $(SRC_DIR)/*.v)
TB_SOURCES := $(wildcard $(TB_DIR)/*.sv $(TB_DIR)/*.v)
ALL_SOURCES := $(RTL_SOURCES) $(TB_SOURCES)

# Tool configuration
{{TOOL_VARS}}

# Default target
.PHONY: all
all: lint sim

#----------------------------------------------------------------------
# Lint
#----------------------------------------------------------------------

.PHONY: lint
lint:
	@echo "==> Running lint..."
	@mkdir -p $(REPORT_DIR)
{{LINT_CMD}}

#----------------------------------------------------------------------
# Simulation
#----------------------------------------------------------------------

.PHONY: sim
sim:
	@echo "==> Running simulation..."
	@mkdir -p $(REPORT_DIR)
{{SIM_CMD}}

.PHONY: sim-gui
sim-gui:
	@echo "==> Running simulation with waveform viewer..."
{{SIM_GUI_CMD}}

#----------------------------------------------------------------------
# Synthesis
#----------------------------------------------------------------------

.PHONY: synth
synth:
	@echo "==> Running synthesis..."
	@mkdir -p $(SYNTH_DIR) $(REPORT_DIR)
{{SYNTH_CMD}}

#----------------------------------------------------------------------
# Clean
#----------------------------------------------------------------------

.PHONY: clean
clean:
	@echo "==> Cleaning build artifacts..."
	rm -rf obj_dir
	rm -f *.vcd *.vvp *.out
	rm -f a.out
	rm -rf $(SYNTH_DIR)/*.v $(SYNTH_DIR)/*.json
	rm -rf $(REPORT_DIR)/*.txt $(REPORT_DIR)/*.log

.PHONY: distclean
distclean: clean
	rm -rf $(SYNTH_DIR) $(REPORT_DIR)

#----------------------------------------------------------------------
# Help
#----------------------------------------------------------------------

.PHONY: help
help:
	@echo "Available targets:"
	@echo "  lint      - Run linter on RTL sources"
	@echo "  sim       - Run simulation"
	@echo "  sim-gui   - Run simulation with waveform viewer"
	@echo "  synth     - Run synthesis"
	@echo "  clean     - Clean build artifacts"
	@echo "  distclean - Clean everything including reports"
	@echo "  help      - Show this help"
	@echo ""
	@echo "Detected tools:"
{{HELP_TOOLS}}
